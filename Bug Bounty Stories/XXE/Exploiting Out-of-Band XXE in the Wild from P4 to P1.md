# ***Exploiting Out-of-Band XXE in the Wild from P4 to P1 üèÜ***
<br>&nbsp;

### *Phase 1 --> Recon üßê*
- *1. Collected list of IP from shodan*<br>
- *2. Made full port scan with rustscan*<br>
- *3. Came across IP with port 9180use some XML content*<br>
- *4. I decided to test XXE*<br>
<br>&nbsp;

### *Phase 2 --> Analysis üß©*
- *1. I tried to retrieve local files, but i got nothing*<br>
- *2. I used XXE payloads and started to compare with the responses differences, but I got nothing again.*<br>
![20230315-1.png](../images/20230315-1.png)<br>
<br>&nbsp;

### *Phase 3 --> SSRF (P4) üç≥*
- *1. I tried to perform an HTTP request to my burp collab.*<br>
- *2. So I tried several payloads until finally one of them worked.*<br>
- *3. Bingoooooo! now I have P4 submission.*<br>
![20230315-2.png](../images/20230315-2.png)<br>
<br>&nbsp;

### *Phase 4 --> Port Scan (P3) üçü*
- *1. I thought what about escalating it to P3 with a simple port scanning?*<br>
- *2. So I sent a simple request to 9180 and another to  1234 and compare the two responses*<br>
- *3. So I made a simple port scan for top 10000 ports,  and I got some open ports :)*<br>
![20230315-3.png](../images/20230315-3.png)<br>
<br>&nbsp;

### *Phase 5 --> Limited OOB XXE (P2) üçî*
- *1. I thought it‚Äôs time to test Out-of-band XXE (picture)*<br>
- *2. So we need a malicious DTD file that requests local files*<br>
- *3. Our malicious DTD requests /etc/hostname file and send it to my IP on 1337 port*<br>
- *4. And guess what?I  got the result*.<br>
![20230315-4.png](../images/20230315-4.png)<br>
![20230315-5.png](../images/20230315-5.png)<br>
<br>&nbsp;

### *Phase 6 --> final XXE (P1) üèÖ*
- *1. I made the OOB XXE exploitation successfully!! But actually, I couldn‚Äôt get any file with multiple lines*<br>
- *2. I tried several techniques such as base64, FTP, ... but i failed in all of them.*<br>
- *3. Finally I was able to do this with error messages*<br>
![20230315-6.png](../images/20230315-6.png)<br>
<br>&nbsp;

-----
## ***Credit***
Based on [Mahmoud Youssef](https://0xmahmoudjo0.medium.com/exploiting-out-of-band-xxe-in-the-wild-16fc6dad9ee2)'s writeup.

----
## ***Support***
You can Follow [me](https://www.linkedin.com/in/bhavesh-pardhi-/) on LinkedIn or
<br><br>[![Buy Me a Coffee](https://img.shields.io/badge/Buy%20Me%20a%20Coffee-Support-orange?style=for-the-badge&logo=buy-me-a-coffee)](https://www.buymeacoffee.com/bhaveshpardhi)
